package dev.cedo.lust.module.impl.exploit;

import dev.cedo.lust.event.impl.player.UpdateEvent;
import dev.cedo.lust.module.Category;
import dev.cedo.lust.module.Module;
import dev.cedo.lust.module.settings.impl.NumberSetting;
import dev.cedo.lust.utils.animations.Animation;
import dev.cedo.lust.utils.time.TimerUtil;
import net.minecraft.item.ItemBow;
import net.minecraft.network.play.client.C03PacketPlayer;

public class FastBowMod extends Module {
    private final TimerUtil timer = new TimerUtil();
    private final NumberSetting delaySetting = new NumberSetting("Delay", 50,500,1,1);

    public FastBowMod() {
        super("FastBow", Category.EXPLOIT, "Makes the bow shoot faster");
        addSettings(delaySetting);
    }

    @Override
    public void onUpdateEvent(UpdateEvent event) {
        if (mc.thePlayer.getHeldItem() != null && mc.thePlayer.getHeldItem().getItem() instanceof ItemBow && mc.thePlayer.isUsingItem()) {
            if (timer.hasTimeElapsed(delaySetting.getValue())) {
                for (int i = 0; i < 20; i++) {
                    mc.rightClickDelayTimer = 0;
                    mc.thePlayer.sendQueue.addToSendQueueSilent(new C03PacketPlayer.C06PacketPlayerPosLook(mc.thePlayer.posX, mc.thePlayer.posY, mc.thePlayer.posZ, mc.thePlayer.rotationYawHead, mc.thePlayer.rotationPitchHead, mc.thePlayer.onGround));
                }
                mc.playerController.onStoppedUsingItem(mc.thePlayer);
                timer.reset();
            }
        } else {
            mc.rightClickDelayTimer = 0;
        }
        super.onUpdateEvent(event);
    }
}
